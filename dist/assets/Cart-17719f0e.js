import{C,j as t,a,F as g}from"./index-0dca03f5.js";import{r as l}from"./motion-4432cab6.js";const w="/assets/cart_icon-40f4b2e1.png";function x({isOpen:d,onClose:h}){const{cartItems:n,removeFromCart:u,cartTotal:p}=l.useContext(C),[o,c]=l.useState(!1),f=async()=>{if(!n.length)return;c(!0);const r=n.map(e=>(e.priceId||console.error("âŒ Missing priceId for",e),{price:e.priceId,quantity:e.quantity||1,size:e.size||null,name:e.name}));console.log("ðŸ‘‰ POST /api/create-checkout-session",r);try{const e=await fetch("/api/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:r})});if(!e.ok){let i={};try{i=await e.json()}catch{}throw new Error(i.error||`HTTP ${e.status}`)}const{url:y,error:s}=await e.json();if(s)throw new Error(s);window.location.href=y}catch(e){console.error("âŒ Error creating checkout session:",e),alert("Checkout failed: "+e.message),c(!1)}},m=n.reduce((r,e)=>r+(e.quantity||1),0);return t("div",{className:`cart-sidebar ${d?"open":""}`,children:[a("button",{className:"close-btn",onClick:h,children:"Ã—"}),t("h2",{children:["Your Cart (",m,")"]}),n.length===0?a("p",{children:"Your cart is empty."}):t(g,{children:[a("ul",{className:"cart-list",children:n.map((r,e)=>a("li",{children:t("div",{className:"cart-item-info",children:[a("p",{children:r.name}),r.size&&t("p",{children:["Size: ",r.size]}),t("p",{children:["Qty: ",r.quantity]}),t("p",{children:["Price: $",r.price.toFixed(2)]}),a("button",{onClick:()=>u(r),children:"Remove"})]})},e))}),t("div",{className:"cart-total",children:[a("strong",{children:"Total:"})," $",p.toFixed(2)]})]}),a("button",{className:"checkout-btn",onClick:f,disabled:o||n.length===0,children:o?"Redirectingâ€¦":"Checkout"})]})}export{x as C,w as a};
